<% breadcrumb :fight, @fight, @fp, @report %>
<div class="container">
  <h3><%= "#{@fight.name} (#{@fp.fight_time / 60}:#{@fp.fight_time % 60})" %></h3>

  <%= link_to('Key Metrics', '?tab=basic', class: 'btn btn-default') %>
  <%= link_to('Resource Management', '?tab=resources', class: 'btn btn-primary') %>
  <%= link_to('Cooldown Usage', '?tab=cooldowns', class: 'btn btn-default') %>
  <br /><br />

  <section>
    <h4>Kegsmash Efficiency</h4>
    <div class="row">
      <div class="col-md-1">2/20</div>
      <div class="col-md-5">
        <div class="bar white" style="width: 100%">
          <div class="bar" style="width: <%= 800 * @fp.kegsmash / @fp.fight_time %>%"><%= @fp.kegsmash %></div>
        </div>
      </div>
      <div class="col-md-3"><%= @fp.kegsmash %> / <%= @fp.fight_time / 8 %> (<%= 800 * @fp.kegsmash / @fp.fight_time %>%)</div>
    </div>
  </section>

  <section>
    <h4>Shuffle Uptime</h4>
    <div class="row">
      <div class="col-md-1">2/20</div>
      <div class="col-md-5">
        <div class="bar white" style="width: 100%">
          <div class="bar" style="width: <%= @fp.shuffle / (10 * @fp.fight_time) %>%">
            <%= @fp.shuffle / (10 * @fp.fight_time) %>%
          </div>
        </div>
      </div>
      <div class="col-md-3"><%= @fp.shuffle / 1000 %>s / <%= @fp.fight_time %>s</div>
    </div>
  </section>

  <section>
    <h4>Time not Energy-Capped</h4>
    <div class="row">
      <div class="col-md-1">2/20</div>
      <div class="col-md-5">
        <div class="bar white" style="width: 100%">
          <div class="bar" style="width: <%= 100*(@fp.fight_time - @fp.capped_time) / @fp.fight_time %>%">
            <%= @fp.fight_time - @fp.capped_time %>s
          </div>
        </div>
      </div>
      <div class="col-md-3"><%= @fp.fight_time - @fp.capped_time %>s / <%= @fp.fight_time %>s</div>
    </div>
  </section>

  <section>
    <h4>Stagger Purified</h4>
    <div class="row">
      <div class="col-md-1">2/20</div>
      <div class="col-md-5">
        <div class="bar white" style="width: 100%">
          <div class="bar" style="width: <%= 100 * (@fp.damage_to_stagger - @fp.damage_from_stagger) / @fp.damage_to_stagger %>%">
            <%= 100 * (@fp.damage_to_stagger - @fp.damage_from_stagger) / @fp.damage_to_stagger %>%
          </div>
        </div>
      </div>
      <div class="col-md-3"><%= (@fp.damage_to_stagger - @fp.damage_from_stagger) / 1000 %>k / <%= @fp.damage_to_stagger / 1000 %>k</div>
    </div>
  </section>
</div>